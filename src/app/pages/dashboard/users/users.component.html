<div class="card overflow-hidden">

  <div class="d-flex p-3 align-items-center border-bottom">
    <h4 class="mb-0 me-3">Users</h4>
    <button class="btn btn-primary ms-auto text-nowrap" (click)="openUserFormDialog(0)"><i
      class="fas fa-plus-circle me-2 text-nowrap"></i>Add New User</button>
  </div>

  <div class="d-flex flex-column overflow-auto" style="height: calc(100vh - 100px)">

    <div class="py-5 d-flex align-items-center justify-content-center" *ngIf="gettingUsers">
      <div class="spinner-border spinner-border-sm" role="status"></div>
      <span class="ms-2 text-nowrap">Loading Users...</span>
    </div>

    <table class="custom-table text-nowrap" *ngIf="!gettingUsers">
      <thead class="bg-light sticky-top">
        <tr>
          <th scope="col">Account</th>
          <th scope="col">Email</th>
          <th scope="col">Added</th>
          <th scope="col">Updated</th>
          <th scope="col">Role</th>
          <th scope="col">Status</th>
          <th scope="col"></th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let user of users">
          <td>
            <div class="d-flex align-items-center">
              <i class="fas fa-user-circle me-2"></i>
              <div class="d-block">
                {{user.name}} {{user.surname}}
              </div>
            </div>
          </td>
          <td>{{user.email}}</td>
          <td>{{user.dateAdded | date:'longDate'}}</td>
          <td>{{user.dateLastUpdated | date:'longDate'}}</td>
          <td>
            <span *ngIf="user.isAdmin">Admin</span>
            <span *ngIf="!user.isAdmin">User</span>
          </td>
          <td>
            <span *ngIf="user.isActivated" class="badge rounded-pill bg-success mr-1">Activated</span>
            <span *ngIf="!user.isActivated" class="badge rounded-pill bg-danger mr-1">Deactivated</span>
          </td>
          <td>
            <button  class="btn btn-secondary btn-circle" [matMenuTriggerFor]="menu"><i class="fas fa-ellipsis-v"></i></button>
            <mat-menu #menu="matMenu" class="custom-dropdown">
              <button class="dropdown-item" type="button" (click)="openViewUserDetailsDialog(user.id)"><i class="fas fa-folder-open"></i>Details</button>
              <button class="dropdown-item" type="button" (click)="openUserFormDialog(user.id)"><i class="fas fa-edit"></i>Edit</button>
              <button class="dropdown-item" type="button" (click)="openActivateUserDialog(user.id)" *ngIf="!user.isActivated"><i class="fas fa-user-check"></i>Activate</button>
              <hr class="my-2">
              <button class="dropdown-item text-danger" type="button" (click)="openDeactivateUserDialog(user.id)" *ngIf="user.isActivated"><i class="fas fa-user-times"></i>Deactivate</button>
              <button class="dropdown-item text-danger" type="button" (click)="openDeleteUserDialog(user.id)"><i class="fas fa-trash"></i>Delete</button>
            </mat-menu>
          </td>
        </tr>
      </tbody>
    </table>

  </div>
</div>



